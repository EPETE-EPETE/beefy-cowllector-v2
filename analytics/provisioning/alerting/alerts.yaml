apiVersion: 1
groups:
    - orgId: 1
      name: Cowllector Alerts
      folder: Cowllector Alerts
      interval: 30m
      rules:
        - uid: f170e2b1-2785-4bbe-8e6e-f5d04ce03780
          title: Cowllector Wallet Native Balance Is Low
          condition: Last balance should alert
          data:
            - refId: all_chains_have_enough_balance
              relativeTimeRange:
                from: 14400
                to: 0
              datasourceUid: PAF11E62F20EEC83B
              model:
                editorMode: code
                format: time_series
                intervalMs: 1000
                maxDataPoints: 43200
                rawQuery: true
                rawSql: |
                    select *
                    from alert_enough_balance
                refId: all_chains_have_enough_balance
                sql:
                    columns:
                        - parameters: []
                          type: function
                    groupBy:
                        - property:
                            type: string
                          type: groupBy
                    limit: 50
            - refId: Last balance should alert
              relativeTimeRange:
                from: 14400
                to: 0
              datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params:
                            - 0
                            - 0
                        type: gt
                      operator:
                        type: and
                      query:
                        params: []
                      reducer:
                        params: []
                        type: avg
                      type: query
                datasource:
                    name: Expression
                    type: __expr__
                    uid: __expr__
                expression: all_chains_have_enough_balance
                intervalMs: 1000
                maxDataPoints: 43200
                reducer: last
                refId: Last balance should alert
                type: reduce
          noDataState: NoData
          execErrState: Error
          for: 2h
          isPaused: false
        - uid: df122fcf-c214-4b04-90fa-d3e0cb3c56e8
          title: Vault Harvest Failed
          condition: last vault harvest status
          data:
            - refId: vault_harvest_success_ts
              relativeTimeRange:
                from: 14400
                to: 0
              datasourceUid: PAF11E62F20EEC83B
              model:
                editorMode: code
                format: time_series
                intervalMs: 1000
                maxDataPoints: 43200
                rawQuery: true
                rawSql: |
                    select *
                    from alert_vault_harvest_in_error
                refId: vault_harvest_success_ts
                sql:
                    columns:
                        - parameters: []
                          type: function
                    groupBy:
                        - property:
                            type: string
                          type: groupBy
                    limit: 50
            - refId: last vault harvest status
              relativeTimeRange:
                from: 14400
                to: 0
              datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params:
                            - 0
                            - 0
                        type: gt
                      operator:
                        type: and
                      query:
                        params: []
                      reducer:
                        params: []
                        type: avg
                      type: query
                datasource:
                    name: Expression
                    type: __expr__
                    uid: __expr__
                expression: vault_harvest_success_ts
                intervalMs: 1000
                maxDataPoints: 43200
                reducer: last
                refId: last vault harvest status
                settings:
                    mode: ""
                type: reduce
          noDataState: OK
          execErrState: Error
          for: 3h
          isPaused: false
        - uid: cacdfe7b-8b6e-4304-8dae-be3346e174c2
          title: Run Error Alert
          condition: last value error
          data:
            - refId: cowllector run errors
              relativeTimeRange:
                from: 14400
                to: 0
              datasourceUid: PAF11E62F20EEC83B
              model:
                editorMode: code
                format: time_series
                intervalMs: 1000
                maxDataPoints: 43200
                rawQuery: true
                rawSql: |
                  select *
                  from alert_run_in_error
                refId: cowllector run errors
                sql:
                    columns:
                        - parameters: []
                          type: function
                    groupBy:
                        - property:
                            type: string
                          type: groupBy
                    limit: 50
            - refId: last value error
              relativeTimeRange:
                from: 14400
                to: 0
              datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params:
                            - 0
                            - 0
                        type: gt
                      operator:
                        type: and
                      query:
                        params: []
                      reducer:
                        params: []
                        type: avg
                      type: query
                datasource:
                    name: Expression
                    type: __expr__
                    uid: __expr__
                expression: cowllector run errors
                intervalMs: 1000
                maxDataPoints: 43200
                reducer: last
                refId: last value error
                settings:
                    mode: ""
                type: reduce
          noDataState: OK
          execErrState: Error
          for: 3h
          isPaused: false
        - uid: a238c42c-cd5e-4050-86cf-64ac3a0954c9
          title: Non-profitable unwrap
          condition: last_harvest_profitable
          data:
            - refId: unwrap unprofitable
              relativeTimeRange:
                from: 21600
                to: 0
              datasourceUid: PAF11E62F20EEC83B
              model:
                editorMode: code
                format: time_series
                intervalMs: 1000
                maxDataPoints: 43200
                rawQuery: true
                rawSql: |
                  select *
                  from alert_unwrap_not_profitable
                refId: unwrap unprofitable
                sql:
                    columns:
                        - parameters: []
                          type: function
                    groupBy:
                        - property:
                            type: string
                          type: groupBy
                    limit: 50
            - refId: last_harvest_profitable
              relativeTimeRange:
                from: 21600
                to: 0
              datasourceUid: __expr__
              model:
                conditions:
                    - evaluator:
                        params: []
                        type: gt
                      operator:
                        type: and
                      query:
                        params:
                            - B
                      reducer:
                        params: []
                        type: last
                      type: query
                datasource:
                    type: __expr__
                    uid: __expr__
                expression: unwrap unprofitable
                intervalMs: 1000
                maxDataPoints: 43200
                reducer: last
                refId: last_harvest_profitable
                type: reduce
          noDataState: OK
          execErrState: Error
          for: 30m
          isPaused: false

